<html>

<head>
<title>Computer Terrorism (UK) :: Security Advisory</title>
<meta http-equiv="Content-Language" content="en-gb">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<LINK REV="made" href="mailto:sales@computerterrorism.com">
<META NAME="keywords" CONTENT="Microsoft Jet Exploit, Microsoft Jet (MSJet40.dll) Exploit, Penetration Testing, Risk Assessment, Audits, Security, Antivirus, Training, Exploits, Hack, Security, Telephony hacking, Denial of Service, Web Design, Secure Web Design,
Internet Explorer Vulnerability, Internet Explorer unpatched vulnerability">
<META NAME="description" CONTENT="Protection for a vulnerable world. Provider of business risk intelligence services and consultancy to businesses and organisations throughout the U.K and europe">
<META NAME="author" CONTENT="administrator">
<META NAME="ROBOTS" CONTENT="ALL">
</head>

<body bgcolor="#EFEFEF" topmargin="0" leftmargin="0"> 






<div align="center">
  <center>
  <table border="0" width="764" cellspacing="0" cellpadding="0" bgcolor="#FFFFFF" height="2929">
    <tr>
      <td width="6" height="67">
		&nbsp;</td>
      <td width="750" height="67" colspan="3">
		<img border="0" src="http://www.computerterrorism.com/images/ctprotection.png" width="453" height="65"></td>
      <td width="8" height="67">
		&nbsp;</td>
    </tr>
    <tr>
      <td width="6" height="17">
        <p align="left">
		&nbsp;</td>
      <td width="750" colspan="3" height="17" bgcolor="#E7E7EF">
        <a target="_self" href="http://www.computerterrorism.com/aboutus2.htm">
        <img border="0" src="http://www.computerterrorism.com/images/aboutus.png" width="81" height="24"></a><a target="_self" href="http://www.computerterrorism.com/assess2.htm"><img border="0" src="http://www.computerterrorism.com/images/services.png" width="68" height="24"></a><a target="_self" href="http://www.computerterrorism.com/research.htm"><img border="0" src="http://www.computerterrorism.com/images/research.png" width="67" height="24"></a><a target="_self" href="http://www.computerterrorism.com/clients.htm"><img border="0" src="http://www.computerterrorism.com/images/clients.png" width="67" height="24"></a><a target="_self" href="http://www.computerterrorism.com/news.htm"><img border="0" src="http://www.computerterrorism.com/images/news.png" width="53" height="24"></a></td>
      <td width="8" height="17">
        &nbsp;</td>
    </tr>
    <tr>
      <td width="6" height="48">
        <p align="center">
		&nbsp;</td>
      <td width="750" colspan="3" height="48">
        <object classid="clsid:D27CDB6E-AE6D-11CF-96B8-444553540000" id="obj1" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0" border="0" width="752" height="55">
			<param name="movie" value="http://www.computerterrorism.com/contactusfade.swf">
			<param name="quality" value="High">
			<embed src="contactusfade.swf" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" name="obj1" width="752" height="55" quality="High"></object>
		</td>
      <td width="8" height="48">
        &nbsp;</td>
    </tr>
    <tr>
      <td width="6" height="21">
        <p align="center">&nbsp;</td>
      <td width="203" height="21">
        &nbsp;</td>
      <td width="549" height="21" colspan="2">
        &nbsp;</td>
      <td width="8" height="21">
        &nbsp;</td>
    </tr>
      </center>
    <tr>
      <td width="6" valign="top" height="110" rowspan="2">
        &nbsp;</td>
      <td width="203" valign="top" height="76">
        <p align="left" style="margin-left: 10">
		<br>
        &nbsp;<img border="0" src="http://www.computerterrorism.com/images/researchheader.png" width="69" height="14" hspace="10"></p>
    </td>
    <center>
    <td width="404" valign="top" rowspan="17" height="2762">
	<p align="left" style="margin-top: 0px"><b>
	<font face="Arial" size="1" color="#325785"><br>
	<br>
	</font><font face="Arial" size="1" color="#5B798E"><br>
	&nbsp;</font></b></p>
	<p align="left" style="margin-top: 0px"><b>
	<font face="Arial" size="1" color="#5B798E"><br>
	<br>
	&nbsp;Security Advisory (Reclassification) : CT21-11-2005</font></b></p>
	<p align="left" style="margin-top: 0px"><b>
	<font face="Arial" size="1" color="#325785"><br>
	&nbsp;</font></b><font face="Arial" size="2" color="#008000"><u>Internet Explorer JavaScript Window() Remote Code Execution</u><br>&nbsp;</font></p>
	<table border="0" width="100%">
		<tr>
			<td width="120"><b><font face="Verdana" size="1" color="#325785">Affected Software:</font></b></td>
			<td><b><font face="Arial" size="1" color="#4A6577">Microsoft Internet Explorer 5.5 &amp; 6.x</font></b></td>
		</tr>
		<tr>
			<td width="120"><b><font face="Verdana" size="1" color="#325785">Severity:</font></b></td>
			<td><b><font face="Arial" size="1" color="#5B798E">Critical 
			(Elevated from 
			low) </font></b></td>
		</tr>
		<tr>
			<td width="120"><b><font face="Verdana" size="1" color="#325785">Impact:</font></b></td>
			<td><b><font face="Arial" size="1" color="#5B798E">Remote System 
			Access</font></b></td>
		</tr>
		<tr>
			<td width="120"><b><font face="Verdana" size="1" color="#325785">Solution Status:</font></b></td>
			<td><b><font face="Arial" size="1" color="#5B798E">Patch now available (see below)</font></b></td>
		</tr>
		<tr>
			<td width="120"><b><font face="Verdana" size="1" color="#325785">CVE 
			Reference: </font>
			</b></td>
			<td><b><font face="Arial" size="1" color="#4A6577">
			<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-1790">
			<font color="#5B798E">CAN-2005-1790</font></a></font></b></td>
		</tr>
		<tr>
			<td width="120"><b><font face="Verdana" size="1" color="#325785">
			Advisory Date:</font></b></td>
			<td><b><font face="Arial" size="1" color="#5B798E">21st November, 
			2005</font></b></td>
		</tr>
		<tr>
			<td width="120">&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td width="120"><b><font face="Verdana" size="1" color="#325785">Credits: </font>
			</b>
			</td>
			<td><b><font face="Arial" size="1" color="#4A6577">Benjamin Tobias 
			Franz (original bug)</font></b></td>
		</tr>
	</table>
	<p align="left" style="margin-top: 0px"><b>
	<font face="Arial" size="1" color="#333333"><br>
	</font><font face="Arial" size="1" color="#5B798E"><br>
	<br>
	</font><font face="Verdana" size="1" color="#325785">1. OVERVIEW</font><font face="Arial" size="1" color="#5B798E"><br>
	</font><font face="Arial" size="1" color="#333333">
	<br>
	</font><font face="Arial" size="1" color="#4A6577">This document serves as a 
	reclassification advisory for the Microsoft Internet Explorer JavaScript 
	Window() DoS vulnerability, originally reported on 31/05/2005.<br>
	<br>
	Contrary to popular beliefs, the aforementioned security issue is susceptible 
	to remote, arbitrary code execution, yielding full system access with the 
	privileges of the underlying user.<br>
	</font><font face="Arial" size="1" color="#5B798E">
	<br>
	<br>
	</font><font face="Arial" size="1" color="#325785">
	<br>
	</font><font face="Verdana" size="1" color="#325785">2. TECHNICAL NARRATIVE</font><font face="Arial" size="1" color="#5B798E"><br>
	<br>
	</font><font face="Arial" size="1" color="#4A6577">As well documented, the 
	vulnerability is instigated by IE's failure to correctly initialise the 
	JavaScript &quot;Window()&quot; function, when used in conjunction with a &lt;BODY onload&gt; 
	event. As a result, Internet Explorer encounters an exception when trying to 
	call a dereferenced 32bit address located in ECX, as highlighted by the 
	following line of code:<br>
	<br>
	CALL DWORD [ECX+8] <br>
	<br>
	Due to the bug, ECX is inadvertently populated by the Unicode representation 
	of a text string named &quot;OBJECT&quot;, or more specifically 0x006F005B. As offset 
	0x006F005B points to an invalid (or non-existent) memory location, Internet 
	Explorer fails to progress, and in turn the end user experiences an 
	application crash (Denial of Service).<br>
	<br>
	Therefore, as the bug does not yield control of any internal register and/or 
	points to an offset of which we have no control, the original &quot;low&quot; risk 
	classification clearly reflects the improbable scenario for remote code 
	execution.</font><font face="Arial" size="1" color="#5B798E"><br>
	<br>
	<br>
	</font><font face="Verdana" size="1" color="#325785">How improbable?</font><font face="Arial" size="1" color="#5B798E"><br>
	<br>
	</font><font face="Arial" size="1" color="#333333">
	<br>
	</font><font face="Arial" size="1" color="#4A6577">If we take a closer look 
	at the vulnerability, we actually see that the instruction is trying to 
	dereference an offset in the range of 0x00600000, which, coincidently, is 
	reserved for the facilitation of all opened Window characteristics on the 
	desktop. <br>
	<br>
	These structures vary in both length and content, but in the main, take the 
	form of window titles, buttons, and any File/edit/View menus bars 
	attributable to a particular Window session.<br>
	<br>
	Consequently, it is feasible to assume that offset 0x006F005B could be 
	arrived at through the invocation of several large Windows structures, 
	for example circa 12 new web browsing sessions, which would increment 
	0x00600000 into 0x006F005B.<br>
	<br>
	If this were possible, it would just leave the problem of trying to identify 
	a means by which custom shellcode could be inserted via one of Window 
	Elements, and correctly aligned against the called [0x006F005B].<br>
	<br>
	Accordingly, several methods were tested. By using a combination of multiple 
	open windows (expanding the memory section), and legal techniques that allow 
	the modification of Window elements (examples below), 3rd party code 
	execution was eventually realised!<br>
	<br>
	Examples:<br>
	<br>
	1. Long HTML &lt;TITLE&gt;<br>
	2. Long Document file names<br>
	3. Large Alert Boxes<br>
	<br>
	<br>
	Unfortunately, all methods tested suffered from one major flaw - inconsistency. 
	<br>
	<br>
	The assumption that a potential victim has a clean desktop 
	(no open apps) compounded by the fact that most window elements encompasses some 
	form of content length restriction, result in very small opportunity for any 
	realistic exploitation.<br>
	<br>
	Except, for one particular approach......a JavaScript prompt box.<br>
	<br>
	By employing a simple technique to invoke multiple occurrences of large 
	JavaScript prompt boxes, it is possible to flood/saturate the remoteness 
	between 0x00600000 - 0x006F005B ++ with data of our choice, yielding very 
	reliable execution of arbitrary code.</font></b></p>
	<p align="left" style="margin-top: 0px"><font color="#325785"><br>
	</font>
	<b><font face="Verdana" size="1" color="#325785">3. PROOF OF CONCEPT</font><font face="Arial" size="1" color="#5B798E"><br>
	<br>
	</font><font face="Arial" size="1" color="#008000">
	<font color="#008000">
	<a href="http://www.computerterrorism.com/research/ie/poc.htm"><span style="text-decoration: none">
	<font color="#008000">http://www.computerterrorism.com/research/ie/poc.htm</font></span></a></font><br>
	</font><font face="Arial" size="1" color="#5B798E"><br>
	&nbsp;</font></b></p>
	<p align="left" style="margin-top: 0px"><b>
	<font face="Verdana" size="1" color="#325785">4. TEMPORARY SOLUTION</font><font face="Arial" size="1" color="#5B798E"><br>
	<br>
	</font><font face="Arial" size="1" color="#4A6577">Until a patch is 
	developed, users are advised to disable active scripting for non-trusted 
	sites.</font><font face="Arial" size="1" color="#5B798E"><br>
	<br>
	&nbsp;</font></b></p>
	<p align="left" style="margin-top: 0px"><b>
	<hpatch><a name='patch'></a></hpatch><font face="Verdana" size="1" color="#325785">5. VENDOR STATUS</font><font face="Arial" size="1" color="#5B798E"><br>
	<br>
	</font><font face="Arial" size="1" color="#4A6577">The original DoS 
	vulnerability was brought to the public's attention on the 31/05/2005 by 
	Benjamin Tobias Franz. To date, the vendor has failed to publicly 
	acknowledge the presence of the flaw, or provide any timescales for an 
	appropriate fix. Accordingly, as of the date of this document, this 
	vulnerability remains UNPATCHED, affecting all users of Microsoft Internet 
	Explorer version 5.5 and 6.x respectively.</font><font face="Verdana" size="1" color="#325785"><br>
	<br>
	13th December 2005 - </font><font face="Arial" size="1" color="#325785">
	Microsoft release patches</font></b></p>
	<p align="left" style="margin-top: 0px"><b>
	<font face="Arial" size="1" color="#5B798E">
    <a href="http://www.microsoft.com/downloads/details.aspx?familyid=4005B74A-D6E6-4A32-A3B1-276686B4A428&displaylang=en">
	<font color="#325785">Internet Explorer 5.01 SP 4 on Microsoft Windows 2000 
	(requires SP 4)</font></a></font><font face="Arial" size="1" color="#325785"><br>
	<br>
	</font><font face="Arial" size="1" color="#5B798E">
	<a href="http://www.microsoft.com/downloads/details.aspx?familyid=A8443CD2-D98D-427B-9F0E-BD7E19FCB994&displaylang=en">
	<font color="#325785">Internet Explorer 6 SP 1 on Microsoft Windows 2000 
	(requires SP 4) or on Microsoft Windows XP (requires SP 1)</font></a><font face="Arial" size="1" color="#325785"><br>
	<br>
	</font>
	<a href="http://www.microsoft.com/downloads/details.aspx?familyid=E4B5BA57-D4F2-4798-9154-2869E371C9D1&displaylang=en">
	<font color="#325785">Internet Explorer 6 for Microsoft Windows XP (requires 
	SP 2)</font></a><font face="Arial" size="1" color="#325785"><br>
	</font><br>
&nbsp;</font></b></p>
	<p align="left" style="margin-top: 0px"><b>
	<font face="Arial" size="1" color="#5B798E">
	<br>
	<br>
	Computer Terrorism (UK)<br>
	<br>
	<br>
	<br>
	<br>
&nbsp;</font></b></p>
	<p align="justify" style="margin-top: 2px">
	<font face="Arial" color="#008000" size="1">
	<a href="http://www.computerterrorism.com">
	<span style="text-decoration: none"><font color="#008000">Home</font></span></a> | 
	<a href="http://www.computerterrorism.com/contact.htm">
	<span style="text-decoration: none"><font color="#008000">Contact Us</font></span></a> | 
	<font color="#008000">
	<span style="text-decoration: none">
	<a href="http://www.computerterrorism.com/assessments.htm" style="text-decoration: none"><font color="#008000">Services</font></a></span></font> |
        <a href="http://www.computerterrorism.com/news.htm"> 
	<span style="text-decoration: none"><font color="#008000"> 
	News</font></span></a><font face="Arial" size="1" color="#5B798E"></font></font><p align="justify" style="margin-top: 2px">
	&nbsp;<p align="justify" style="margin-top: 2px">
	</font></td>
    <td width="145" valign="top" rowspan="17" height="2762">&nbsp;</td>
    <td width="8" valign="top" rowspan="17" height="2762">&nbsp;</td>
    </tr>
    <tr>
      <td width="203" valign="top" height="40">
        <p style="margin-left: 25px"><font color="#5B798E"><br>
		</font><b>
		<font color="#5B798E" face="Arial" size="1">
		<a style="text-decoration: none" href="http://www.computerterrorism.com/research/ct12-09-2006.htm">
		<font color="#5B798E">CT12-09-2006<br>
		Adobe Flash Player<br>
		Vulnerability<br>
		...........................................</font></a></font></b></td>
    </tr>
    <tr>
      <td width="6" height="31">
        &nbsp;</td>
      <td width="203" valign="top" height="40">
        <p style="margin-left: 25px"><b>
		<font color="#5B798E" face="Arial" size="1">
		<br>
		<a style="text-decoration: none" href="http://www.computerterrorism.com/research/ct12-09-2006-2.htm">
		<font color="#5B798E">CT12-09-2006-2<br>
		Microsoft Publisher</font></a></font><font color="#008000" face="Arial" size="1"><a style="text-decoration: none" href="http://www.computerterrorism.com/research/ct12-09-2006-2.htm"><font color="#5B798E"><br>
		Font Parsing Vulnerability<br>
		...........................................</font></a></font></b></td>
    </tr>    
    <tr>
      <td width="6" height="31">
        &nbsp;</td>
      <td width="203" valign="top" height="40">
        <p style="margin-left: 25px"><b>
		<span style="text-decoration: none">
		<font color="#5B798E" face="Arial" size="1"><br>
		<a style="text-decoration: none" href="http://www.computerterrorism.com/research/ct22-03-2006.htm">
		<font color="#5B798E">CT22-03-2006<br>
		</font></a>
		</font>
		<font color="#008000" face="Arial" size="1">
		<a style="text-decoration: none" href="http://www.computerterrorism.com/research/ct22-03-2006.htm"><font color="#5B798E">
		Microsoft Internet Explorer CreateText-Range <br>
		Vulnerability</font></a></font><font color="#5B798E" face="Arial" size="1"></a></font></span><font color="#008000" face="Arial" size="1"><a href="http://www.computerterrorism.com/research/ct22-03-2006.htm" style="text-decoration: none"><font color="#5B798E"><br>
		...........................................</font></a></font></b></td>
    </tr>    
     <tr>
      <td width="6" height="28">
        &nbsp;</td>
      <td width="203" valign="top" height="40">
        <p style="margin-left: 25px"><b>
		<font color="#5B798E" face="Arial" size="1"><br>
		</font><font color="#008000" face="Arial" size="1">
		<span style="text-decoration: none">
		<font color="#5B798E">
		<a href="http://www.computerterrorism.com/research/ie/ct21-11-2005" style="text-decoration: none">
		<font color="#008000">CT21-11-2005 <br>
		Internet Explorer Javascript Window() Vulnerability</font></a></font></span><br>
		...........................................</font></b></td>
    </tr>
    
    <tr>
      <td width="6" height="30">
        &nbsp;</td>
      <td width="203" valign="top" height="40">
        <p style="margin-left: 25px"><b>
		<font color="#5B798E" face="Arial" size="1"><br>
		<a target="_blank" href="http://www.computerterrorism.com/research/ie/poc.htm" style="text-decoration: none">
		<font color="#5B798E">CT21-11-2005 PoC</font></a><br>
		...........................................</font></b></td>
    </tr>
    <tr>
      <td width="6" height="36">
        &nbsp;</td>
      <td width="203" valign="top" height="48">
        <p style="margin-left: 25px"><b>
		<font color="#008000" face="Arial" size="1"><br>
		</font>
		<font color="#5B798E" face="Arial" size="1">
		<span style="text-decoration: none">
		<a href="http://www.computerterrorism.com/research/msjet.htm" style="text-decoration: none">
		<font color="#5B798E">MS Jet Exploit 
		(unpatched)</font></a></span><br>
		...........................................</font></b></td>
    </tr>
    <tr>
      <td width="6" height="36">
        &nbsp;</td>
      <td width="203" valign="top" height="556">
        <p style="margin-left: 25px"><b>
		<font color="#5B798E" face="Arial" size="1"><br>
		<font color="#5B798E"><span style="text-decoration: none">
		<a href="http://www.computerterrorism.com/research/forthcoming.htm" style="text-decoration: none">
		<font color="#5B798E">Forthcoming 
		advisories</font></a></span></font><br>
		...........................................</font></b></td>
    </tr>
    <tr>
      <td width="6" height="1920">
        &nbsp;</td>
      <td width="203" valign="top" height="1920">
        &nbsp;</td>
    </tr>
    <tr>
      <td width="6" height="464">
        &nbsp;</td>
      <td width="203" height="464">
        <p style="margin-left: 28">&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td valign="top" height="11" width="6">
        &nbsp;</td>
      <td valign="top" height="11" width="203">
        <p style="margin-left: 28">&nbsp;</td>
    </tr>
    <tr>
      <td width="6" height="21">
        &nbsp;</td>
      <td width="203" height="21">
        <p style="margin-left: 28">&nbsp;</p>
      </td>
    </tr>
    <tr>
      <td width="6" height="21">&nbsp;</td>
      <td width="203" height="21">&nbsp;</td>
    </tr>
    <tr>
      <td width="6" height="21">&nbsp;</td>
      <td width="203" height="21">&nbsp;</td>
    </tr>
    <tr>
      <td width="6" valign="top" height="21">
        &nbsp;</td>
      <td width="203" valign="top" height="21">
        &nbsp;
    </td>
    </tr>
    <tr>
      <td width="6" valign="top" height="21">
        &nbsp;</td>
      <td width="203" valign="top" height="21">
        &nbsp;
    </td>
    </tr>
    <tr>
      <td width="6" valign="top" height="19">
        &nbsp;</td>
      <td width="203" valign="top" height="19">
        &nbsp;
    </td>
    </tr>
    </table>
  </center>
</div>

</body>

</html>